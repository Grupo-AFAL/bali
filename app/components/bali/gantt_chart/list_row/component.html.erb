<%= tag.div class: 'gantt-chart-row',
    data: {
      id: task.id,
      controller: 'gantt-foldable-item',
      'gantt-foldable-item-visible-value': true,
      'gantt-foldable-item-folded-value': false,
      'sortable-update-url': task.update_url,
      'gantt-chart-target': 'listRow'
    },
    style: "height: #{task.total_row_height}px" do %>
  <div class="gantt-chart-row-contents">
    <%= render Bali::Icon::Component.new('handle', class: 'handle') if !readonly %>
    <%= render Bali::Icon::Component.new('chevron-down', class: 'chevron-down', data: { action: 'click->gantt-foldable-item#toggle' }) if task.children.any? %>

    <%= render Bali::Tooltip::Component.new(class: class_names(children: task.children.any?)) do |tip| %>
      <% tip.trigger do %>
        <% if task.href %>
          <%= tag.a task.name,
                    href: task.href,
                    class: 'task-name',
                    **task.options %>
        <% else %>
          <%= tag.div task.name,
                      class: 'task-name',
                      **task.options %>
        <% end %>
      <% end %>

      <%= tag.p task.name %>
    <% end %>
  </div>

  <% if task.children.any? %>
    <div class="gantt-chart-list-children"
        data-controller="sortable-list"
        data-sortable-list-group-name-value="gantt-list"
        data-sortable-list-handle-value=".handle"
        data-sortable-list-list-id-value="<%= task.id %>"
        data-sortable-list-pull-value="false"
        data-sortable-list-disabled-value="<%= readonly %>"
        data-sortable-list-animation-value="50"
    >
      <% task.children.each do |child_task| %>
        <%= render Bali::GanttChart::ListRow::Component.new(task: child_task, readonly: readonly) %>
      <% end %>
    </div>
  <% end %>
<% end %>
